---
title: "Deploy a Hono App to Cloudflare Workers."
emoji: "ğŸ”¥"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Hono","TypeScript","Cloudflare"]
published: false
---
ã“ã®ãƒ¡ãƒ¢ã¯ã€Hono ã§ Web Application ã‚’å®Ÿè£…ã—ãŸæ™‚ã«ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚

Hono ã§ SSR ã‚’è©¦ã—ã¾ã™ã€‚

Topic ã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã™ã€‚

- Hono[^1]
- Cloudflare Workers[^2]

[^1]: https://hono.dev/

ã•ã‚‰ã«è©³ã—ãè¦‹ãŸã„æ–¹ã¯èª­ã¿ç¶šã‘ã¦ãã ã•ã„ã€‚

---

2023å¹´9æœˆ4å›ç›®ã§ã™ã€‚

ä»Šå›ã¯ã€ã€Œè¶…é«˜é€Ÿãª Frameworkã€ã§è©±é¡Œã® HonoğŸ”¥ ã«ã¤ã„ã¦å­¦ã³ã¾ã™ã€‚

ã“ã†ã„ã†ã‚‚ã®ã‚’ä½œã‚Œã‚‹ã‚ˆã†ãª Software Engineer ã«ãªã‚ŠãŸã„ã§ã™ã€‚å°Šæ•¬ã€‚

ç¾è·ã®çµ„ç¹”å•é¡Œã«æ„šç—´ã£ã¦ã‚‹ã®ãŒæ°—æŒã¡ãŒæ™´ã‚Œã¾ã™ã€‚â¤ï¸â€ğŸ”¥

ä»Šå›ä½œæˆã—ãŸã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã§ã™ã€‚

https://github.com/danny-yamamoto/my-portfolio-hono-ts

https://my-portfolio-hono-ts.yamamoto-daisuke.workers.dev/

## é–‹ç™ºç’°å¢ƒ
- Visual Studio Code Dev Containers
- Node.js: `v20.5.0`
- Hono: `3.6.0`

## Project æ§‹æˆ

ã“ã¡ã‚‰ã‚’å‚è€ƒã«å®Ÿè£…ã—ã¾ã—ãŸã€‚

https://github.com/honojs/examples/tree/main/jsx-ssr

:::details Project Structure
```bash
.
â”œâ”€â”€ package.json                  # edit
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ public
â”œâ”€â”€ README.md
â”œâ”€â”€ src                           # add
â”‚   â”œâ”€â”€ components                # add
â”‚   â”‚   â””â”€â”€ Layout.tsx            # add
â”‚   â”œâ”€â”€ index.tsx                 # add
â”‚   â””â”€â”€ pages
â”‚       â”œâ”€â”€ articles.tsx          # add
â”‚       â”œâ”€â”€ certificates.tsx      # add
â”‚       â”œâ”€â”€ experience.tsx        # add
â”‚       â”œâ”€â”€ footer.tsx            # add
â”‚       â”œâ”€â”€ repositories.tsx      # add
â”‚       â””â”€â”€ top.tsx               # add
â””â”€â”€ tsconfig.json                 # edit
```
:::

## Start the development server

https://github.com/danny-yamamoto/my-portfolio-hono-ts/blob/bd3b9613d9ea65c72720d90be802ad3af2b3c330/package.json#L4-L6

:::details npm run dev
```bash
node âœ /workspaces/my-portfolio-hono-ts (main) $ npm run dev

> dev
> run-p dev:*


> dev:esbuild
> esbuild --bundle src/index.tsx --format=esm --watch --outfile=dist/_worker.js


> dev:wrangler
> wrangler dev src/index.tsx --live-reload

[watch] build finished, watching for changes...
 â›…ï¸ wrangler 3.9.1 (update available 3.10.0)
------------------------------------------------------
wrangler dev now uses local mode by default, powered by ğŸ”¥ Miniflare and ğŸ‘· workerd.
To run an edge preview session for your Worker, use wrangler dev --remote
â” Starting local server...
[mf:wrn] The latest compatibility date supported by the installed Cloudflare Workers Runtime is "2023-09-22",
but you've requested "2023-09-28". Falling back to "2023-09-22"...
[mf:inf] Ready on http://0.0.0.0:8787 
[mf:inf] - http://127.0.0.1:8787
[mf:inf] - http://172.17.0.2:8787
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ [b] open a browser, [d] open Devtools, [l] turn off local mode, [c] clear console, [x] to exit                                                                                          â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```
:::

## Build

https://github.com/danny-yamamoto/my-portfolio-hono-ts/blob/bd3b9613d9ea65c72720d90be802ad3af2b3c330/package.json#L7

:::details npm run build
```bash
node âœ /workspaces/my-portfolio-hono-ts (main) $ npm run build

> build
> esbuild --bundle src/index.tsx --format=esm --outfile=dist/_worker.js


  dist/_worker.js  57.1kb

âš¡ Done in 44ms
node âœ /workspaces/my-portfolio-hono-ts (main) $ 
```
:::

## Deploy a Hono site
- Cloudflare Workers[^2]
- Deploy Step
   1. Cloudflare ã« login
   1. ã€ŒWorkers & Pagesã€ã‚’ã‚¯ãƒªãƒƒã‚¯
   1. ã€Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
   1. ã€ŒWorkersã€tab ã‚’ã‚¯ãƒªãƒƒã‚¯
   1. ã€Œãƒ¯ãƒ¼ã‚«ãƒ¼ã®ä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
   1. åå‰ã‚’å…¥åŠ›ã€‚å…¥åŠ›ã—ãŸåå‰ + domain
   1. ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
   1. ã€Œã‚¯ã‚¤ãƒƒã‚¯ç·¨é›†ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
   1. local ã§ build ã—ãŸ `dist/_worker.js` ã‚’è²¼ã‚Šä»˜ã‘
   1. ã€Œä¿å­˜ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯

[^2]: https://developers.cloudflare.com/workers/

## Summary
- Hono ã«ã¤ã„ã¦æ›¸ãã¾ã—ãŸã€‚
- Deploy ã™ã‚‹ã®ã«æ‰‹é–“å–ã‚Šã¾ã—ãŸã€‚Workers ã§ã® deploy ã«æ°—ä»˜ãã¾ã§1æ—¥ç¨‹åº¦æ‚©ã¿ã¾ã—ãŸã€‚
- Hono ã§è‰²ã€…è©¦ã—ã¦ã¿ãŸã„éƒ¨åˆ†ãŒã‚ã‚‹ãŸã‚ã€ç¶™ç¶šã—ã¦å­¦ã‚“ã§ã„ãã¾ã™ã€‚
